(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35b85792"],{"0c6d":function(e,t,s){"use strict";s("d3b7");var r=s("bc3a"),n=s.n(r),o=s("5c96"),a=s("2f4d"),i=s("a18c"),l=n.a.create({timeout:5e3});l.interceptors.request.use((function(e){var t=Object(a["b"])();return t&&(e.headers["token"]=t),e}),(function(e){return console.log(e),Promise.reject(e)})),l.interceptors.response.use((function(e){var t=e.data;return 20002==t.code&&(Object(a["a"])(),i["b"].push("/login")),t}),(function(e){return console.log("err"+e),Object(o["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)})),t["a"]=l},"46eb":function(e,t,s){"use strict";s("9148")},"58c3":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-main"},[s("div",{staticClass:"container"},[s("el-card",{staticClass:"card",attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.goAdd}},[e._v("新增角色")])],1),s("el-table",{attrs:{data:e.roleList,border:"",stripe:""}},[s("el-table-column",{attrs:{label:"#",type:"index",width:"50",fixed:""}}),s("el-table-column",{attrs:{label:"角色名称",prop:"roleName",width:"200",fixed:""}}),s("el-table-column",{attrs:{label:"角色编码",prop:"roleCode",width:"200"}}),s("el-table-column",{attrs:{label:"备注",prop:"remark"}}),s("el-table-column",{attrs:{label:"添加时间",prop:"createTime",width:"200"}}),s("el-table-column",{attrs:{label:"操作",prop:"nickName",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(s){return e.goEdit(t.row.id)}}},[e._v("编辑")]),s("el-button",{attrs:{type:"error",size:"mini"},on:{click:function(s){return e.goDel(t.row.id)}}},[e._v("删除")])]}}])})],1),s("el-pagination",{staticStyle:{"margin-top":"30px","text-align":"right"},attrs:{"current-page":e.page.start,"page-sizes":e.page.sizes,"page-size":e.page.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalCount},on:{"update:currentPage":function(t){return e.$set(e.page,"start",t)},"update:current-page":function(t){return e.$set(e.page,"start",t)},"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],1),s("RoleForm",{ref:"roleForm",attrs:{"menu-list":e.menuList},on:{refresh:e.getRoleList}})],1)},n=[],o=s("f7ab"),a=s("8595"),i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"role-form"},[s("el-dialog",{attrs:{title:"编辑角色",visible:e.dialog,width:"30%"},on:{"update:visible":function(t){e.dialog=t},close:e.handleClose}},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px",inline:!1,size:"normal"}},[s("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[s("el-input",{attrs:{size:"small"},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),s("el-form-item",{attrs:{label:"角色编码",prop:"roleCode"}},[s("el-input",{attrs:{size:"small"},model:{value:e.form.roleCode,callback:function(t){e.$set(e.form,"roleCode",t)},expression:"form.roleCode"}})],1),s("el-form-item",{attrs:{label:"角色描述",prop:"remark"}},[s("el-input",{attrs:{type:"textarea",size:"small"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),s("el-form-item",{attrs:{label:"选择菜单"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:6,offset:0}},[s("el-checkbox",{attrs:{indeterminate:!1},on:{change:e.handelExpand},model:{value:e.isExpand,callback:function(t){e.isExpand=t},expression:"isExpand"}},[e._v("展开/关闭")])],1),s("el-col",{attrs:{span:6,offset:0}},[s("el-checkbox",{attrs:{indeterminate:!1},on:{change:e.handleSelectAll},model:{value:e.isSelectAll,callback:function(t){e.isSelectAll=t},expression:"isSelectAll"}},[e._v("全选/取消权限")])],1)],1),s("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoad,expression:"treeLoad"}],ref:"tree",attrs:{"node-key":"id","show-checkbox":"",data:e.menuList,props:e.defaultProps}})],1)],1),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.doSave}},[e._v("确定")])],1)],1)],1)},l=[],c=s("5530"),u={name:"AuthUser",props:{menuList:{type:Array,required:!0}},data:function(){return{treeLoad:!1,dialog:!1,isExpand:!1,isSelectAll:!1,defaultProps:{label:"title",children:"children"},form:{},rules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],menuIds:[]},selectKeys:[]}},created:function(){},methods:{openDialog:function(e){var t=this;this.dialog=!0,e&&(this.treeLoad=!0,o["a"].getRolePermissions(e).then((function(e){e.success?(e.data.role.permissionIds&&(t.$refs.tree.setCheckedKeys(e.data.role.permissionIds),delete e.data.role.permissionIds),t.form=e.data.role):t.$message.error("查询失败!"),t.treeLoad=!1})))},handleClose:function(){this.dialog=!1,this.$refs.form.resetFields(),this.$refs.tree.setCheckedKeys([])},doSave:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return e.$message.error("请注意表单验证!"),!1;var s=null,r=Object(c["a"])(Object(c["a"])({},e.form),{},{permissionIds:e.$refs.tree.getCheckedKeys()});s=r.id?o["a"].updateRolePermissions:o["a"].saveRolePermissions,s(r).then((function(t){t.success?(e.$message.success("保存成功!"),e.handleClose(),e.$emit("refresh")):e.$message.error("保存失败!")}))}))},handelExpand:function(e){this.setAllExpand(e)},setAllExpand:function(e){var t=this.$refs.tree.store.nodesMap;for(var s in t)t[s].expanded=e},handleSelectAll:function(e){e?(this.seltAllSelect(this.menuList),this.$refs.tree.setCheckedKeys(this.selectKeys)):this.$refs.tree.setCheckedKeys([])},seltAllSelect:function(e){for(var t=0;t<e.length;t++){var s=e[t];this.selectKeys.push(s.id),s.children&&s.children.length>0&&this.seltAllSelect(s.children)}}}},d=u,m=(s("46eb"),s("2877")),f=Object(m["a"])(d,i,l,!1,null,"6c57f1b4",null),h=f.exports,p={name:"AuthUser",components:{RoleForm:h},data:function(){return{search:{username:"abc"},roleList:[],page:{start:1,limit:10,sizes:[10,20,30,40],totalCount:0},menuList:[]}},created:function(){this.getRoleList(),this.getAllMenuList()},methods:{goAdd:function(){this.$refs.roleForm.openDialog()},goEdit:function(e){this.$refs.roleForm.openDialog(e)},getRoleList:function(){var e=this;o["a"].findRolesByPage(this.page.start,this.page.limit).then((function(t){t.success?(e.roleList=t.data.rows,e.page.totalCount=t.data.total):e.$message.error(t.message)}))},doReset:function(){this.$refs.searchForm.resetFields()},doSearch:function(){},sizeChange:function(e){},currentChange:function(e){},getAllMenuList:function(){var e=this;a["a"].findAllPermissions().then((function(t){t.success?e.menuList=t.data.menus:e.$message.error("获取数据失败!"),e.loading=!1}))},goDel:function(e){var t=this;this.$confirm("确认删除角色?").then((function(s){o["a"].removeRole(e).then((function(e){e.success?(t.$message.success("删除成功!"),t.getRoleList()):t.$message.error("删除失败")}))}))}}},g=p,b=(s("eab1"),Object(m["a"])(g,r,n,!1,null,"0dd35081",null));t["default"]=b.exports},8595:function(e,t,s){"use strict";var r=s("0c6d");function n(e){return Object(r["a"])({url:"/admin/sysAuth/permission/findAllPermissions",method:"GET",data:e})}function o(e){return Object(r["a"])({url:"/admin/sysAuth/permission/remove/".concat(e),method:"DELETE"})}function a(e){return Object(r["a"])({url:"/admin/sysAuth/permission/save",method:"POST",data:e})}function i(e){return Object(r["a"])({url:"/admin/sysAuth/permission/saveInitMenus",method:"POST",data:e})}function l(e){return Object(r["a"])({url:"/admin/sysAuth/permission/update",method:"PUT",data:e})}function c(e){return Object(r["a"])({url:"/admin/sysAuth/permission/saveRolePermission",method:"POST",data:e})}function u(e){return Object(r["a"])({url:"/admin/sysAuth/permission/selectAllMenu/".concat(e),method:"GET"})}t["a"]={findAllPermissions:n,removePermission:o,savePermission:a,updatePermission:l,saveRolePermission:c,selectAllMenu:u,saveInitMenus:i}},9148:function(e,t,s){},"916b":function(e,t,s){},eab1:function(e,t,s){"use strict";s("916b")},f7ab:function(e,t,s){"use strict";s("99af");var r=s("0c6d");function n(e,t,s){return Object(r["a"])({url:"/admin/sysAuth/role/findRolesByPage/".concat(e,"/").concat(t),method:"GET",data:s})}function o(){return Object(r["a"])({url:"/admin/sysAuth/role/findAllRoles",method:"GET"})}function a(e){return Object(r["a"])({url:"/admin/sysAuth/role/removeRole/".concat(e),method:"DELETE"})}function i(e){return Object(r["a"])({url:"/admin/sysAuth/role/saveRolePermissions",method:"POST",data:e})}function l(e){return Object(r["a"])({url:"/admin/sysAuth/role/updateRolePermissions",method:"PUT",data:e})}function c(e){return Object(r["a"])({url:"/admin/sysAuth/role/findRolePermissions/".concat(e),method:"GET"})}t["a"]={findRolesByPage:n,removeRole:a,saveRolePermissions:i,updateRolePermissions:l,getRolePermissions:c,findAllRoles:o}}}]);